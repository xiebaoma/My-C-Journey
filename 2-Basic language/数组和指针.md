# C++ 中的数组与指针

数组和指针是 C++ 中重要的基础知识，它们紧密相关，经常在一起使用。数组是固定大小的元素集合，而指针则是指向内存位置的变量。理解数组和指针之间的关系，对于编写高效和安全的 C++ 代码至关重要。

## 目录

1. [数组基础](#数组基础)
2. [数组与指针的关系](#数组与指针的关系)
3. [指针基础](#指针基础)
4. [指针与数组的结合使用](#指针与数组的结合使用)
5. [动态数组](#动态数组)
6. [总结](#总结)

---

## 数组基础

在 C++ 中，数组是一种数据结构，它可以存储一组相同类型的元素。数组的大小在创建时是固定的，不能动态调整。数组的元素可以通过下标进行访问。

### 数组声明与初始化

```cpp
#include <iostream>
using namespace std;

int main() {
    // 声明一个大小为 5 的整数数组并初始化
    int arr[5] = {1, 2, 3, 4, 5};

    // 输出数组中的每个元素
    for (int i = 0; i < 5; i++) {
        cout << arr[i] << " ";
    }

    return 0;
}
```

### 数组的大小

数组的大小在编译时确定，一旦定义就不可改变。如果没有为数组提供所有的初始化值，未初始化的元素将被自动赋值为 0。

```cpp
int arr[5] = {1, 2};  // 剩下的元素会被自动初始化为 0
```

### 数组的内存布局

数组是连续存储的。例如，如果你声明了一个整数数组，它的每个元素会被存储在内存中的连续位置。因此，可以通过指针访问数组的元素。

---

## 数组与指针的关系

在 C++ 中，数组名本质上是指向数组第一个元素的指针。数组和指针有一些共通点，但它们并不完全相同。

### 数组名是指针常量

数组名代表了数组的起始地址，因此它是指向第一个元素的指针。数组名是一个常量，不能改变它所指向的位置。

```cpp
#include <iostream>
using namespace std;

int main() {
    int arr[5] = {1, 2, 3, 4, 5};
    
    // 数组名作为指针使用
    cout << "arr[0] = " << *arr << endl;  // 访问第一个元素，输出 1
    cout << "arr[1] = " << *(arr + 1) << endl;  // 访问第二个元素，输出 2

    return 0;
}
```

### 数组和指针的区别

- **数组**：一旦声明，大小是固定的，不能改变它的大小。
- **指针**：可以在运行时动态地指向不同的内存地址。

### 注意：数组名与指针的区别

- 数组名在表达式中通常会被自动转换为指向第一个元素的指针，但它不是指针。数组名无法修改或改变指向的位置，而指针则可以。

```cpp
int arr[5];
int *p = arr;  // p 指向 arr[0]
p = p + 1;  // p 可以修改，指向 arr[1]
```

---

## 指针基础

指针是一个变量，它存储的是另一个变量的内存地址。指针是 C++ 中一个非常强大的特性，可以帮助开发者高效地操作内存。

### 指针声明

```cpp
int num = 10;
int *ptr = &num;  // ptr 是一个指向 int 类型的指针，存储 num 的地址
```

### 解引用

通过解引用操作符 `*`，可以访问指针指向的变量。

```cpp
cout << *ptr << endl;  // 输出 ptr 指向的值，即 num 的值 10
```

### 指针的指针

指针的指针（`int **p`）是一个指向指针的指针，它存储另一个指针的地址。

```cpp
int num = 10;
int *ptr = &num;
int **pptr = &ptr;  // pptr 是一个指向 ptr 的指针

cout << **pptr << endl;  // 输出 10
```

---

## 指针与数组的结合使用

数组和指针通常一起使用，指针提供了对数组的灵活访问。通过指针，你可以遍历数组中的元素，甚至通过指针改变数组的内容。

### 使用指针遍历数组

```cpp
#include <iostream>
using namespace std;

int main() {
    int arr[5] = {1, 2, 3, 4, 5};
    int *ptr = arr;  // ptr 指向数组的第一个元素

    for (int i = 0; i < 5; i++) {
        cout << *(ptr + i) << " ";  // 使用指针访问数组元素
    }

    return 0;
}
```

### 指针和数组参数

在 C++ 中，可以通过指针传递数组，或者传递指向数组的指针作为参数。

```cpp
#include <iostream>
using namespace std;

void printArray(int *arr, int size) {
    for (int i = 0; i < size; i++) {
        cout << *(arr + i) << " ";
    }
}

int main() {
    int arr[5] = {1, 2, 3, 4, 5};
    printArray(arr, 5);  // 传递指向数组的指针

    return 0;
}
```

### 使用指针修改数组内容

通过指针，你可以直接修改数组的内容，甚至可以动态分配内存来创建“动态数组”。

---

## 动态数组

动态数组是指在运行时分配的数组，它的大小在程序运行时才能确定。可以使用 `new` 和 `delete` 来动态分配和释放内存。

### 创建动态数组

```cpp
#include <iostream>
using namespace std;

int main() {
    int *arr = new int[5];  // 动态分配一个包含 5 个整数的数组

    // 初始化并打印动态数组
    for (int i = 0; i < 5; i++) {
        arr[i] = i + 1;
        cout << arr[i] << " ";
    }

    delete[] arr;  // 释放动态数组的内存

    return 0;
}
```

### 注意事项：
- 动态数组在使用 `new` 分配内存后需要手动释放内存（使用 `delete[]`）。
- 忘记释放动态分配的内存可能会导致内存泄漏。

---

## 总结

- **数组** 是一种固定大小的元素集合，可以通过下标访问其元素。
- **指针** 是存储内存地址的变量，可以指向数组、变量、函数等，具有更高的灵活性。
- 数组和指针有着密切的关系，数组名通常被视为指向数组第一个元素的指针。
- **动态数组** 是通过 `new` 关键字动态分配的内存，可以在运行时调整数组大小。
- 使用指针时需要特别注意内存的管理，确保不会出现内存泄漏或越界访问。

